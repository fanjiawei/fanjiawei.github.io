---
layout: post
title:  "Spring经验!"
date:   2015-08-01 18:07:37
categories: Java Spring 后端
---
Spring可真是坑啊！

我的时间全部浪费在研究如何注入这些技术难题上了。

不过没办法，用其他的只怕是更慢。

## 1.如何注入Map，Set，List等等这些Collection

{% highlight java %}
//注册Bean
@Bean(name="protectedResource")
public Map<String,String> protectedResource(){
    return ImmutableMap.of(
            "/admin/**","admin",
            "/api/**", "client"
    );
}

//注入
@Value("#{protectedResource}")
private Map<String,String> protectedResource;
{% endhighlight %}

## 2.如何将抛出的异常显示为网页

{% highlight java%}
//在interceptor里抛出异常，controller同理
public boolean preHandle(HttpServletRequest request, HttpServletResponse response, Object handler) throws Exception {
    URL url = new URL(request.getRequestURL().toString());
    String subDomain = url.getHost().split("\\.")[0];
    if (groupDao.countBySubDomain(subDomain) > 0) {
        request.setAttribute(Common.PARAM_SUB_DOMAIN, subDomain);
        return true;
    }

    throw new GroupNotFoundException(subDomain);
}

//一个专门的类，用来处理所有的异常
@ControllerAdvice
public class ExceptionController {
    @ExceptionHandler(GroupNotFoundException.class)
    public String groupNotFound() {
        return "exception/groupNotFound";
    }
}
{% endhighlight %}